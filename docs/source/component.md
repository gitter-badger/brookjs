---
id: component
title: <code>component</code>
---

The `component` module exports a factory method, providing a declarative way of generating `Kefir.Observable`s to manage the application UI lifecycle. They are designed to mount an already rendered DOM, with the server providing the DOM and a `Kefir.Observable` of component props.

`component` factories can be composed of several `Kefir.Observable`-returning functions, described below, which form a `Kefir.Observable`-returning function of its own. Each of these configuration options are optional. A `component` that doesn't do anything may not be particularly useful, but it is valid.

# How to Use

A `component` factory function is generated by passing an configuration object into the factory method.

```js
// dummy.js
import { component } from 'brookjs';
import Kefir from 'kefir';

const events = el => Kefir.fromEvents(el, 'click')
    .map(() => ({ type: 'COMPONENT_CLICK' }));

const render = (el, props, update) => Kefir.stream(emitter => {
   let loop = requestAnimationFrame(() => {
       el.disabled = update.disabled;

       emitter.end();
   });

   return () => cancelAnimationFrame(loop);
});

export default component({ events, render });
```

Somewhere else, mount the component to its element and subscribe to its actions:

```js
// app.js
import DummyComponent from './dummy';

const { __INITIAL_STATE__ } = global;

const app = DummyComponent(el.getElementById('app'), __INITIAL_STATE__);

let sub = app.observe({ value: action => console.log(action)});
```

Each of these configuration options have an associated `brookjs` module, which exports a factory method for generating these functions from a configuration.

* [brookjs/render](render.html)
* [brookjs/events](events.html)
* [brookjs/children](children.html)

## Configuration Object

The configuration object defines the behavior of the component over its lifecycle. All stream generating functions provide ways of emitting values into the component stream. All of the properties of the configuration object are optional.

_Note: **All functions must be curried.** `brookjs` relies on [`ramda`][ramda] for functional programming helpers, and highly recommends using the same. Use [`babel-plugin-ramda`][babel-ramda] to ensure the smallest possible build._

* `{Function}` events - `events$` stream returning function. Called when a `render$` stream ends with the component's element, allowing the component to rebind events to the new DOM. The previous `events$` stream is unsubscribed, ensuring event bindings are cleared between renders.
    * Parameters:
        * `{Element}` el - Component element.
    * Returns:
        * `{Kefir.Observable}` Observable of events from the element.
* `{Function}` render - `render$` stream returning function. Called whenever the props change, passing the component element `el`, the `previous` props, and the `next` props.
    * Parameters:
        * `{Element}` el - Component element.
        * `{Object}` prev - Previous component props.
        * `{Object}` next - Next component props.
    * Returns:
        * `{Kefir.Observable}` Observable of events from the element. Should ends when the element is updated, allowing the events to be rebound. Can also simply emit the component's actions, providing compatibility with React or virtual-dom based rendering. If the previous render stream never ends, `events` will never be called.

            When the next `render$` stream is generated, the previous stream is unsubscribed, ensuring all cleanup code is called. This allows animations to terminate midway.
* `{Function}` children - `children$` stream returning function. Called once, when the component is mounted, passing the component element `el`.
    * Parameters:
        * `{Element}` el - Component element.
        * `{Kefir.Observable}` props$ - Observable of props. Used to render children.
    * Returns:
        * `{Kefir.Observable}` Observable of events from the children. Does not need to end.
* `{Function}` combinator - Hook to combine streams before returning them from the factory. Merges the streams by default.
    * Paramters:
        * `{Object}` streams - Object containing a property for each component stream, including `events$`, `render$`, `children$`, and `onMount$`. Should return a new stream combining the provided events. Provides a hook to coordinate stream events, if necessary.
* `{Function}` onMount - `onMount$` stream returning function. Called once, when the component is mounted, providing an entry point for any custom event or render logic.
    * Parameters:
        * `{Element}` el - Componenent element.
        * `{Kefir.Observable}` props$ - Observable of props. Used to render children.
    * Returns:
        * `{Kefir.Observable}` - Observable of events from the component.
* `{Function}` shouldUpdate - Determines whether to re-render the element. Called with the previous and next props, returning a boolean indicating whether the component should re-render. Returns true be default.
    * Parameters:
        * `{Object}` prev - Previous props.
        * `{Object}` next - Next props.
    * Returns:
        * `{boolean}` Whether the component should re-render.

  [fsa]: https://github.com/acdlite/flux-standard-action
  [ramda]: ramdajs.com
  [babel-ramda]: https://www.npmjs.com/package/babel-plugin-ramda
